あなたは /mnt/Coordy リポジトリで動作している AI 開発アシスタントです。
Next.js(App Router) + Amplify(Cognito) プロジェクトのフロント／認証まわりの不具合を修正してください。

前回あなたが実施した作業完了レポートでは、z-index や displayName、パスワードリセット、DOCS 更新などが完了と記載されていますが、ユーザー側から見ると以下の点がまだ直っていません。

---

## 0. 作業前のルール

### 0-1. まず読むべき DOCS

作業に入る前に、以下のファイルを必ず読み、現状の仕様と用語を把握してください。

- DOCS/README.md
- DOCS/site-map.md
- DOCS/flows/login-flow.md
- DOCS/AUTH.md
- DOCS/IMPLEMENTATION.md
- DOCS/flows/main-user-flows.md

### 0-2. DOCS の扱いルール

- DOCS 配下の .md ファイルは **削除しない／リネームしない**。
- 仕様とコードがズレている場合は、今回の依頼内容を優先しつつ、
  - DOCS の該当セクションのみ **最小限** 修正して整合性をとる。
  - 大量削除や章構成の大改造はしない。
- 新しい仕様を書く場合は、「セクション追加」か「表の行追加」程度にとどめる。

### 0-3. タスクの書き方

- 最初に、今回の作業を **T-001, T-002, ...** の形で Markdown テーブルで宣言してください。
- そのあと、タスクごとに実装を進めてください。
- すべて完了後、「作業完了レポート」を Markdown で出力してください。
  - タスクごとの対応内容
  - 変更したファイル一覧
  - 実行したコマンド（lint, build など）と結果
  - 残っている懸念点・TODO があれば明示

---

## 1. まだ直っていないポイント（実際の症状）

### P-001: / 初回アクセス時に Header のログインボタンが効かない

- URL: http://localhost:3000/
- 症状:
  - **初回アクセス時**（ページを開いた直後）、Header の「ログイン」ボタンがクリックできない。
  - ページをリロードするとクリックできるようになる。
- 要望:
  - リロードしなくても、**最初の表示からログインボタンが普通に押せるようにしてほしい**。
- 追加要望:
  - トップページの「ユーザーの新規登録」ボタンについて、
    - ログイン状態でもボタンの文言は「マイページへ」ではなく、**「ユーザー新規登録」表現のまま**にしてほしい。
    - 遷移先ロジック（ログイン済みなら /user に飛ばす 等）はそのままでも良いが、**ラベルは「マイページへ」に変えない**でほしい。

※ 前回レポートでは z-index の再設計が完了とありましたが、/ での初回アクセスではまだ問題が残っています。  
  `/user` ではなく、**公開トップページの Header 周り** を重点的に確認してください。

---

### P-002: /login/instructor で新規登録したばかりのユーザーがログインできない

- URL: http://localhost:3000/login/instructor
- 症状:
  - 新規にインストラクター（サービス出品者）としてサインアップしたユーザーが、
    /login/instructor からログインしようとしてもログインできない。
- 要件（仕様イメージ）:
  - 管理者の最終許可は必要だが、
    - **インストラクターアカウントの作成と初期設定まではログインできて OK**。
    - ただし、「サービス作成」は管理者が許可するまでできないようにしたい。
      - 許可が下りれば、サービス作成は何個でもできる想定。

やってほしいこと（方向性）：

1. インストラクターアカウントの signUp〜verify〜login の流れをコードと DOCS から確認する。
   - Cognito グループ（`instructor` など）を前提にしたチェックで、ログインが弾かれていないか。
   - ログイン時に「instructor グループに属していないとログイン不可」というロジックになっていないか。
2. 認証レベルと権限レベルを分ける：
   - **ログイン（アプリに入る）** こと自体は、インストラクターとして登録 → メール確認完了 → ログイン までで可能にする。
   - 一方で「サービス作成」「本番公開」などは、管理者の approval フラグ（例: `isApproved`）を見るようにする。
     - 未承認なら、「現在、管理者による承認待ちです」のようなメッセージ表示 & サービス作成ボタンを押せないなどの UI 制御。
3. 上記の仕様に沿うように、/login/instructor のログイン判定やロールチェックを調整する。
   - 「ログインできない」状態が、ビジネス仕様ではなく実装バグである可能性があるので、原因を特定して修正してほしい。
4. 関連する仕様を DOCS に反映（最小限）：
   - 例：DOCS/flows/login-flow.md や DOCS/flows/main-user-flows.md に、
     - 「インストラクターは登録直後でもログインできるが、サービス作成は管理者承認後」のような一文を追記。

---

### P-003: /user/services, /user/favorites にユーザー用 Header が無い

- URL:
  - http://localhost:3000/user/services
  - http://localhost:3000/user/favorites
- 症状:
  - `/user` にあるユーザー用 Header（AppHeader）が、上記のページには表示されていない。
- 要望:
  - `/user` に表示されているのと同じユーザー用 Header を、
    - `/user/services`
    - `/user/favorites`
    など、ユーザー用の配下ページでも表示してほしい。

実装の方向性（例）：

- `app/user/(protected)/layout.tsx` に Header を含めた共通レイアウトが定義されているなら、
  - `/user/services`, `/user/favorites` が確実にその layout 配下になるようにルーティング構造を見直す。
- もし各 page.tsx 内で個別に Header を読んでいるなら、
  - layout で一括管理する形に寄せるか、
  - 少なくとも `/user/services` と `/user/favorites` でも同じ Header コンポーネントを使う。

---

### P-004: Admin ページの実装状況確認

- 質問: 「Adminページの実装できてる？」
- 想定される URL（DOCS/flows/login-flow.md などから確認）：
  - 例）`/manage/login`, `/manage/admin` など

やってほしいこと：

1. Admin ログイン〜ダッシュボードのルートと実装状況を確認する。
   - ルーティング（app/manage/...）
   - 認証ガード（middleware や layout）
   - Admin ロール判定（Cognito グループや customRole）
2. 現時点で「使える状態」かどうかを整理し、レポートにまとめてください。
   - 例）
     - ログインはできるが、まだダッシュボード UI が仮
     - ルートはあるが、実際には 404
     - ログイン成功しても /manage/admin にリダイレクトされない など
3. 必要最低限の修正があれば、合わせて実装して構いません（ただし大規模な新規開発までは不要）。

---

## 2. タスク化の例

タスク一覧は、例えば次のような形で宣言してください（必要に応じて増減OK）：

| Task ID | 内容 |
|--------|------|
| T-001  | / 初回アクセス時の Header ログインボタンが効かない問題の原因調査と修正 |
| T-002  | トップページの「ユーザー新規登録」ボタンのラベル／挙動の見直し |
| T-003  | /login/instructor で新規インストラクターがログインできない問題の調査・修正（権限設計の見直し含む） |
| T-004  | /user/services, /user/favorites にユーザー用 Header を適用 |
| T-005  | Admin ページ（/manage/admin 等）の実装状況確認と必要に応じた最小修正 |

---

## 3. 最終確認・レポート

すべてのタスク対応後、次の点を自己チェックしてください：

- http://localhost:3000/
  - 初回アクセス時から Header のログインボタンが普通にクリックできる。
  - 「ユーザー新規登録」の文言が「マイページへ」に勝手に変わっていない（仕様どおりになっている）。

- http://localhost:3000/login/instructor
  - 新規登録したインストラクターアカウントでログインできる。
  - ログイン後、インストラクター用の初期設定やダッシュボードに進める。
  - サービス作成など、「管理者承認が必要な機能」は適切に制御されている。

- http://localhost:3000/user/services / http://localhost:3000/user/favorites
  - `/user` と同じユーザー Header が表示されている。

- Admin ページ
  - DOCS に書かれているルートと実際の挙動に矛盾がない。
  - 少なくともログイン〜ダッシュボード表示までの最小フローが確認できている。

最後に、「作業完了レポート」を Markdown で出力してください。

- タスクごとの対応内容（T-001〜）
- 変更したファイル一覧
- 実行したコマンド（lint / build / 必要ならテストなど）
- まだ残っている懸念点・制約（あれば）

