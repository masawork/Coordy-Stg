あなたは /mnt/Coordy リポジトリで動作している AI 開発アシスタントです。
Next.js(App Router) + Amplify(Cognito) プロジェクトのログインまわりと UI（ヘッダー／メニュー）を修正してください。

今回のゴールは主に以下の2点です：

1. **ユーザーとしてログイン中でも、インストラクターとしてログインできるようにすること**
2. **クライアント（ユーザー側）のメニューをハンバーガーボタンで折りたためるようにすること**

---

## 0. 作業前ルール

### 0-1. まず読む DOCS（必須）

作業を始める前に、必ず以下を読み、現状仕様を把握してください：

- DOCS/README.md
- DOCS/site-map.md
- DOCS/flows/login-flow.md
- DOCS/AUTH.md
- DOCS/IMPLEMENTATION.md
- DOCS/flows/main-user-flows.md

特に：

- 「ユーザーログイン」「インストラクターログイン」「複数ロール」の扱い
- 以前、UserAlreadyAuthenticatedException まわりの仕様をどう書いたか

をちゃんと確認した上で実装に入ってください。

### 0-2. DOCS の扱い

- DOCS 配下の .md は **削除しない／リネームしない**。
- 仕様とコードがズレている場合は、今回の要望を正として、
  - DOCS 側の該当箇所だけを **最小限** 修正して整合性をとること。
- 新しい仕様を足す場合も、セクション追加や表の行追加レベルにとどめてください。

### 0-3. タスク宣言

作業を始める前に、まず **T-001, T-002, ...** の形でタスク一覧を Markdown テーブルで出力してください。

例（内容はあなたの判断でよいですが、だいたいこんな感じ）：

| Task ID | 内容 |
|--------|------|
| T-001  | /login/instructor の「ユーザーログイン中でもインストラクターログイン可能」にする |
| T-002  | DOCS（login-flow など）の仕様を現実の挙動に合わせて更新 |
| T-003  | クライアントメニュー（ユーザー用）をハンバーガーで折りたたみ可能にする |

このようにタスクを分解して宣言した上で、実装に進んでください。

---

## 1. まだ直っていないポイント

### P-001: /login/instructor でユーザーログイン中にログインできない

- URL: http://localhost:3000/login/instructor
- 現状の挙動（ユーザー報告）：
  - すでにユーザーとしてログインしている状態で、/login/instructor にアクセスし、インストラクターとしてログインしようとすると、
    以下のメッセージが表示されてログインできません。

    > すでに別のアカウント（ユーザー）でログインしています。別のアカウントでログインするには、一度ログアウトしてからやり直してください。

- 依頼したい挙動：
  - **ユーザーとしてログイン中でも、インストラクターとしてログインできるようにしてほしい**。
  - 手動でいちいちログアウトさせるのではなく、/login/instructor からそのままインストラクターとして使えるようにしたい。

### 考慮してほしい実装方針

- Cognito / Amplify 的に「同じブラウザセッションで2ユーザー同時ログイン」はできない制約があるので、
  - 技術的には「内部でユーザー→インストラクターにセッションを切り替える」形になるはずです。
- 望むユーザー体験としては：

  1. ユーザーとしてログイン中の状態で /login/instructor へアクセス
  2. インストラクター用メール＋パスワードでログインフォーム送信
  3. 裏側で、もし既に別アカウントでログインしている場合：
     - 自動でサインアウト → 新しい資格情報でサインイン
  4. 成功したら `/instructor` へ遷移
  5. ユーザーには「ログアウトしてからやり直してください」というエラーは**出さない**

- つまり、「ユーザー／インストラクターを切り替えるときに自動でセッションを切り替える」ようにしてほしい、というイメージです。

### やってほしいこと（T-001 の中身のイメージ）

1. `lib/auth/cognito.ts` のログイン処理（loginUser・loginInstructor 相当）を確認。
   - 現在 `UserAlreadyAuthenticatedException` を捕捉して日本語メッセージに変換しているはずなので、そのロジックを見直してください。
2. `/login/instructor` の submit ハンドラと組み合わせて：
   - もしログイン時に「既に別ユーザーでログイン中」であることが判明したら、
     - 明示的に `signOut()` → そのまま同じ資格情報で `signIn()` をリトライする流れに変更。
   - その結果、ユーザー側にはエラーを出さず、「インストラクターとしてログイン完了」させる。
3. `/login/user` 側はどうするかも検討してください。
   - 同じブラウザで「インストラクター→ユーザー」に切り替える場合も、同じ発想（自動セッション切替）にしておくと整合的です。
4. DOCS との整合：
   - 以前、「すでに別アカウントでログインしている場合はログアウトしてから」という文言を DOCS に書いている可能性があります。
   - 今回の仕様変更に合わせて、`DOCS/flows/login-flow.md` や `DOCS/AUTH.md` からその説明を修正し、
     - 「別ロールでログインした場合は、システム側で自動的にセッションを切り替える」ことを簡潔に書き直してください。

---

## 2. クライアントメニュー（ユーザー用）をハンバーガーで折り畳み

ユーザー側のサブメニューに Header が追加されたのは OK でした。  
次に、**「クライアントメニューはハンバーガーボタン押したら折り畳めるように」** してほしいです。

- 対象：
  - `/user` 配下のユーザー用メニュー（クライアントメニュー）
  - おそらく `app/user/(protected)/layout.tsx` や関連コンポーネントでサイドバー／メニューが実装されていると思います。

### やってほしいこと（T-003 のイメージ）

1. モバイル・タブレットサイズなどで、
   - ハンバーガーボタン（≡ アイコン）を押すとメニューが開閉するようにする。
   - もう一度押すと閉じる。
2. すでにサイドバーのオーバーレイやメニューコンポーネントが存在するはずなので、
   - それらを流用しつつ、「クライアントメニューが常に開きっぱなし」にならないようにする。
3. レイアウトや z-index まわりは、前回の調整（AppHeader / サイドバー周り）を壊さないように注意してください。

---

## 3. 最終チェックとレポート

すべての対応が完了したら、以下を自己確認してください：

1. ユーザーとしてログイン中の状態で `/login/instructor` へアクセスし、
   - インストラクター用メール＋パスワードでログインしたときに、
     - 以前のメッセージ「すでに別のアカウント（ユーザー）でログインしています…」が出ず、
     - 自動的にインストラクターとしてログインでき、`/instructor` へ遷移すること。
2. 同様に、インストラクターからユーザー側に切り替える挙動も確認してください（必要に応じて）。
3. `/user` 配下（例：`/user`, `/user/services`, `/user/favorites` など）で、
   - ハンバーガーボタンを押すとクライアントメニューが開閉すること。
4. `npm run build` が成功すること（既存のビルド成功は維持）。

最後に、「作業完了レポート」を Markdown で出力してください：

- タスク一覧（T-001〜）と対応内容
- 変更したファイル一覧（パス＋概要）
- 実行したコマンド（lint / build など）と結果
- DOCS にどのような変更を加えたか
- まだ残っている懸念点や TODO があれば明示

